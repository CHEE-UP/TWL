# 200207 금

알고리즘

장고

기술 면접



## 알고리즘

boj.kr/1920

```c++
이분탐색이라서 꼭 재귀함수를 돌려야 한다고 생각했는데 반복문으로 충분히 가능했다.

시간 초과가 나서 뭐지 했는데 아래 코드 붙이니깐 바로 됐다.
ios::sync_with_stdio(0);
cin.tie(0);
```





## 장고

바꾸기 전 코드..

```Python
from django.shortcuts import render
from .models import *
from .serializers import *
from rest_framework import permissions, generics
from rest_framework.response import Response
from rest_framework import status
from dailypicture.permissions import IsOwner
from rest_framework.permissions import IsAuthenticated

class PostList(generics.ListCreateAPIView):
    permission_classes = [IsAuthenticated, IsOwner]
    queryset = Post.objects.all()
    serializer_class = PostSerializer
    def perform_create(self, serializer):
        serializer.save(owner=self.request.user)

    def list(self, request):
        queryset = Post.objects.filter(owner=request.user)
        serializer = PostSerializer(queryset, many=True)
        return Response(serializer.data)

class PostDetail(generics.RetrieveUpdateDestroyAPIView):
    permission_classes = [IsAuthenticated, IsOwner]
    queryset = Post.objects.all()
    serializer_class = PostDetailSerializer
```

다른 시리얼라이저 클래스를 사용하니까 list, detail을 당연히 나눠야 한다고 생각했다. 뷰셋을 공부하고 나니 self.action 을 통해서 나누면 된다는 것을 깨달았고 모델 뷰셋을 사용해서 하나로 합쳤다.



뷰셋을 적용해서 바꾸고 난 후 

```python
from rest_framework import viewsets
from .serializers import *
from dailypicture.permissions import IsOwner
from rest_framework.permissions import IsAuthenticated

class PostViewSet(viewsets.ModelViewSet):
    permission_classes = [IsAuthenticated, IsOwner]
    # queryset = Post.objects.all()

    def get_queryset(self):
        queryset = Post.objects.filter(owner=self.request.user)
        return queryset

    def get_serializer_class(self):
        if self.action == 'retrieve':
            return PostDetailSerializer
        return PostSerializer

    def perform_create(self, serializer):
        serializer.save(owner=self.request.user)

    def perform_destroy(self, instance):
        for image in instance.images.all():
            image.url.delete(save=False)
        instance.delete()
```

의문점은 get_queryset 함수를 써도 queryset 변수는 꼭 써야 했다. serializer는 함수만 써도 됐다. 둘이 같은 동작을 하는 것 같은데 왜 queryset 변수를 꼭 써야할까 의문이였음.



그런데‼️ 라우터에 basename 을 붙여주니 됐다.  basename을 안붙였을 경우 queryset 변수에 저장한 모델 이름으로 url을 만들어주기 때문.

queryset 변수를 안쓰고 싶다면 라우터에 basename을 붙여줄것

```
router = DefaultRouter()
router.register(r'', PostViewSet, basename='post')
```

